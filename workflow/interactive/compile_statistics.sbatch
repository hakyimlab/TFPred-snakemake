#!/bin/bash

#SBATCH --job-name=compile_statistics
#SBATCH --partition=caslake
#SBATCH --nodes=1
#SBATCH --cpus-per-task=4
#SBATCH --time=01:00:00
#SBATCH --mem-per-cpu=8G
#SBATCH --error=/beagle3/haky/users/temi/projects/TFPred-snakemake/slurm_logs/compile_statistics.err
#SBATCH --output=/beagle3/haky/users/temi/projects/TFPred-snakemake/slurm_logs/compile_statistics.log
#SBATCH --account=pi-haky

date
source ~/.bashrc

conda activate /beagle3/haky/users/shared_software/TFXcan-pipeline-tools

/beagle3/haky/users/shared_software/TFXcan-pipeline-tools/bin/Rscript workflow/src/compile_statistics.R \
    --transcription_factors "AR,AR,AR,AR,ARNT,ARNT,ARNT,ASCL1,ASCL1,ATF1,ATF1,ATF2,ATF2,ATF2,ATF2,ATF3,ATF3,ATF3,ATF3,ATF3,ATF3,ATF3,ATF4,BACH1,BACH1,BACH2,BARX1,BATF,BATF,BCL11A,BCL11A,BCL6,BCL6,BCL6,BHLHE40,BHLHE40,BHLHE40,BHLHE40,CDX2,CEBPA,CEBPA,CEBPA,CEBPA,CEBPA,CLOCK,CLOCK,CREB1,CREB1,CREB1,CREB1,CREB1,CREB1,CREB1,CREB1,CREB1,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCF,CTCFL,CTCFL,CTCFL,CUX1,CUX1,CUX1,DLX1,DMC1,DUX4,DUX4,E2F1,E2F1,E2F1,E2F1,E2F1,E2F1,E2F1,E2F3,E2F4,E2F4,E2F4,E2F4,E2F4,E2F6,E2F6,E2F6,E2F6,E2F7,E2F7,EBF1,EBF1,EGR1,EGR1,EGR1,EGR1,EGR1,EGR1,EGR2,ELF1,ELF1,ELF1,ELF1,ELF1,ELF1,ELF1,ELF3,ELK1,ELK1,ELK1,ELK1,ELK4,EOMES,EPAS1,ERG,ERG,ERG,ERG,ESR1,ESR1,ESR1,ESR1,ESR1,ESR1,ESR1,ESRRA,ESRRA,ESRRA,ETS1,ETS1,ETS1,ETS1,ETS1,ETS1,ETV1,ETV1,ETV1,ETV4,ETV4,FLI1,FLI1,FLI1,FLI1,FLI1,FLI1,FLI1,FOS,FOS,FOS,FOS,FOS,FOSL1,FOSL1,FOSL1,FOSL1,FOSL2,FOSL2,FOSL2,FOSL2,FOSL2,FOXA1,FOXA1,FOXA1,FOXA1,FOXA1,FOXA1,FOXA1,FOXA1,FOXA1,FOXA2,FOXA2,FOXA2,FOXA2,FOXA2,FOXH1,FOXK2,FOXK2,FOXM1,FOXM1,FOXM1,FOXM1,FOXM1,FOXM1,FOXO1,FOXO1,FOXO3,FOXO3,FOXO3,FOXP1,FOXP1,FOXP1,FOXP1,FOXP1,GABPA,GABPA,GABPA,GABPA,GABPA,GABPA,GABPA,GABPA,GABPA,GATA1,GATA1,GATA1,GATA1,GATA2,GATA2,GATA2,GATA2,GATA3,GATA3,GATA3,GATA3,GATA3,GATA3,GATA3,GATA3,GATA4,GATA4,GATA4,GATA4,GATA4,GFI1B,GLI2,GLI2,GRHL2,GRHL2,GRHL2,HIF1A,HIF1A,HIF1A,HIF1A,HINFP,HINFP,HLF,HNF1A,HNF1A,HNF1B,HNF4A,HNF4A,HNF4A,HOXA2,HOXA9,HOXB13,HOXB13,HOXC9,HSF1,HSF1,HSF1,HSF1,HSF1,IRF1,IRF1,IRF1,IRF1,IRF3,IRF4,IRF4,IRF9,JUN,JUN,JUN,JUN,JUN,JUN,JUN,JUN,JUN,JUNB,JUNB,JUNB,JUND,JUND,JUND,JUND,JUND,JUND,JUND,JUND,JUND,JUND,JUND,JUND,KLF1,KLF1,KLF10,KLF4,KLF4,KLF4,KLF4,KLF4,KLF5,KLF5,KLF5,KLF5,KLF6,KLF9,KLF9,LEF1,LHX2,MAFB,MAFF,MAFF,MAFK,MAFK,MAFK,MAFK,MAFK,MAFK,MAFK,MAX,MAX,MAX,MAX,MAX,MAX,MAX,MAX,MAX,MAX,MAX,MAZ,MAZ,MAZ,MAZ,MAZ,MAZ,MEF2A,MEF2A,MEF2A,MEF2C,MEF2D,MITF,MNT,MNT,MYB,MYB,MYBL2,MYBL2,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYC,MYCN,MYNN,MYNN,MYOD1,MYOG,NANOG,NANOG,NEUROG2,NFATC1,NFATC1,NFE2,NFE2,NFE2L2,NFE2L2,NFIA,NFIA,NFIL3,NFYA,NFYA,NFYA,NFYA,NR2C2,NR2C2,NR2C2,NR2C2,NR2C2,NR2F1,NR2F1,NR2F2,NR2F2,NR2F2,NR2F2,NR2F2,NR2F6,NR2F6,NR3C1,NR3C1,NR3C1,NR3C1,NR3C1,NR3C1,NR3C1,NR3C1,NR3C1,NR3C1,NR4A1,NR5A2,NRF1,NRF1,NRF1,NRF1,NRF1,NRF1,NRF1,NRF1,OTX2,PAX3,PAX5,PAX8,PBX1,PBX2,PBX2,PBX3,PBX3,PBX3,PBX3,PDX1,PGR,PKNOX1,POU2F2,POU5F1,POU5F1,PPARG,PPARG,PRDM1,PRDM1,PRDM10,PRDM14,RARA,RARA,RARA,RARG,RBPJ,RELA,RELA,RELA,RELA,RELA,RELA,RELA,RELA,RELA,RELA,REST,REST,REST,REST,REST,REST,REST,REST,REST,REST,REST,REST,REST,RFX1,RFX1,RFX1,RFX2,RFX5,RFX5,RFX5,RFX5,RFX5,RFX5,RFX5,RUNX1,RUNX1,RUNX1,RUNX1,RUNX1,RUNX1,RUNX1,RUNX1,RUNX2,RXRA,RXRA,RXRA,RXRA,RXRA,RXRA,SCRT1,SIX1,SIX1,SIX2,SIX2,SMAD2,SMAD3,SMAD3,SMAD4,SMAD4,SMAD4,SNAPC1,SOX2,SOX2,SOX2,SOX2,SOX2,SOX2,SOX4,SOX9,SP1,SP1,SP1,SP1,SP1,SP1,SP1,SP2,SP2,SP2,SP2,SPDEF,SPI1,SPI1,SPI1,SPI1,SPI1,SPI1,SPI1,SPI1,SPIB,SREBF1,SREBF1,SREBF1,SREBF2,SRF,SRF,SRF,SRF,SRF,SRF,SRF,SRF,STAT1,STAT1,STAT1,STAT3,STAT3,STAT3,STAT3,STAT3,STAT3,STAT3,STAT3,STAT4,STAT5A,STAT5A,TAL1,TAL1,TAL1,TAL1,TAL1,TAL1,TAL1,TAL1,TBP,TBP,TBP,TBP,TBP,TBX21,TCF12,TCF12,TCF12,TCF12,TCF12,TCF12,TCF12,TCF21,TCF4,TCF4,TCF7,TCF7,TCF7L1,TCF7L1,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TCF7L2,TEAD1,TEAD2,TEAD4,TEAD4,TEAD4,TEAD4,TEAD4,TEAD4,TEAD4,TEAD4,TFAP2A,TFAP2A,TFAP2A,TFAP2C,TFAP2C,TFAP2C,TFAP2C,TFAP4,TGIF2,THAP11,TP53,TP53,TP53,TP53,TP53,TP53,TP53,TP53,TP53,TP53,TP63,TP63,TP63,TP63,TP63,TP63,TP73,USF1,USF1,USF1,USF1,USF1,USF1,USF1,USF1,USF2,USF2,USF2,USF2,USF2,VDR,VDR,VDR,WT1,YY1,YY1,YY1,YY1,YY1,YY1,YY1,YY1,YY1,YY1,ZBTB33,ZBTB33,ZBTB33,ZBTB33,ZBTB33,ZBTB33,ZBTB33,ZBTB7A,ZBTB7A,ZBTB7A,ZBTB7A,ZEB1,ZEB1,ZEB1,ZEB1,ZEB1,ZEB2,ZEB2,ZFX,ZFX,ZFX,ZFX,ZFX,ZFX,ZIC2,ZKSCAN1,ZKSCAN1,ZKSCAN1,ZNF143,ZNF143,ZNF143,ZNF143,ZNF143,ZNF143,ZNF263,ZNF263,ZNF317,ZNF341,ZNF382,ZNF467,ZNF528,ZNF692,ZNF711,ZSCAN22" \
    --tissues "Breast,EmbryonicKidney,MammaryGland,Prostate,BoneMarrow,Breast,Kidney,Lung,Skin,BoneMarrow,Liver,Blood,Colon,Embryo,EmbryonicKidney,Blood,BoneMarrow,Colon,Embryo,Liver,Lung,Skin,Liver,BoneMarrow,Embryo,Blood,Colon,Blood,BoneMarrow,Blood,EmbryonicKidney,Blood,BoneMarrow,Tonsil,Blood,BoneMarrow,Liver,Lung,Colon,Adipose,Blood,BoneMarrow,Liver,Pleura,Bone,Colon,Blood,BoneMarrow,Colon,Embryo,Endometrium,Liver,Lung,MammaryGland,Prostate,Adipose,Blood,Bone,BoneMarrow,Brain,Breast,Cerebellum,Cervix,Colon,ConnectiveTissue,Cordblood,Embryo,EmbryonicKidney,Endometrium,Esophagus,Eye,FetalLiver,FetalLung,Foreskin,Gingiva,Heart,Kidney,Liver,Lung,MammaryGland,Pancreas,PancreaticIslet,Prostate,PulmonaryArtery,Retina,SigmoidColon,SkeletalMuscle,Skin,SpinalCord,Spleen,Stomach,UmbilicalVein,gastroesophagealsphincter,BoneMarrow,Breast,Colon,Blood,BoneMarrow,Breast,Colon,Testis,Muscle,SkeletalMuscle,Blood,BoneMarrow,Breast,Cervix,MammaryGland,Prostate,UmbilicalCord,Colon,Adipose,Blood,BoneMarrow,Breast,Cervix,BoneMarrow,Cervix,Embryo,Lung,Colon,Lung,Adipose,Blood,Blood,BoneMarrow,Breast,Colon,Embryo,Endometrium,EmbryonicKidney,Blood,BoneMarrow,Brain,Breast,Colon,Liver,Lung,Pancreaticductal,Blood,BoneMarrow,Breast,Cervix,Cervix,Embryo,Kidney,Blood,BoneMarrow,Breast,Prostate,Bone,Breast,Endometrium,MammaryGland,Prostate,Uterus,endometrioidadenocarcinoma,Blood,Breast,Liver,Blood,BoneMarrow,Lung,Pancreas,Prostate,UmbilicalVein,BoneMarrow,Prostate,Stomach,Liver,Prostate,Blood,BoneMarrow,Brain,Cordblood,Muscle,Pleura,UmbilicalVein,Blood,BoneMarrow,Breast,Cervix,UmbilicalVein,BoneMarrow,Breast,Colon,MammaryGland,Brain,Breast,Endometrium,Liver,Lung,Breast,Embryo,Endometrium,Liver,Lung,MammaryGland,Pancreaticductal,Prostate,endometrioidadenocarcinoma,Colon,Embryo,Liver,Lung,Skin,Embryo,BoneMarrow,Liver,Blood,Brain,Breast,Cervix,EmbryonicKidney,Endometrium,Endometrium,Tonsil,BoneMarrow,Colon,Liver,Blood,BoneMarrow,Colon,Embryo,Prostate,Blood,BoneMarrow,Brain,Breast,Cervix,Embryo,Liver,Lung,Prostate,Blood,BoneMarrow,Cordblood,FetalLiver,Blood,BoneMarrow,Prostate,UmbilicalVein,Blood,BoneMarrow,Brain,Breast,Embryo,Lung,MammaryGland,Thymus,Embryo,Liver,Lung,Skin,Stomach,EmbryonicKidney,Blood,Colon,Breast,Bronchia,Prostate,Bone,Cervix,Kidney,MammaryGland,BoneMarrow,Colon,Liver,Epididymis,Liver,Pancreaticductal,Colon,Embryo,Liver,Colon,Kidney,Colon,Prostate,Brain,Bone,Breast,Liver,Lung,MammaryGland,Blood,BoneMarrow,Colon,Pancreaticductal,Cervix,Blood,BoneMarrow,BoneMarrow,BoneMarrow,Breast,Cervix,Colon,Coronaryarterysmoothmuscle,Liver,Lung,MammaryGland,UmbilicalVein,Blood,BoneMarrow,Colon,Blood,BoneMarrow,Brain,Breast,Cervix,Colon,Coronaryarterysmoothmuscle,Embryo,Liver,Lung,MammaryGland,Prostate,BoneMarrow,EmbryonicKidney,Liver,Breast,Foreskin,Lung,Pancreaticductal,Skin,Colon,Headandneck,Pancreaticductal,Stomach,Pancreaticductal,Breast,EmbryonicKidney,BoneMarrow,Colon,Foreskin,BoneMarrow,Liver,Blood,BoneMarrow,Cervix,Colon,Embryo,Liver,Lung,Blood,BoneMarrow,Brain,Breast,Cervix,Colon,Embryo,Endometrium,Liver,Lung,UmbilicalVein,Blood,BoneMarrow,Cervix,EmbryonicKidney,Liver,Lung,Blood,BoneMarrow,Brain,Blood,BoneMarrow,Skin,Colon,Liver,Blood,PeripheralBlood,Cervix,Liver,Blood,Bone,BoneMarrow,Brain,Breast,Cervix,Colon,Embryo,EmbryonicKidney,LNCaPcells,Liver,Lung,MammaryGland,Prostate,Skin,UmbilicalVein,BoneMarrow,BoneMarrow,EmbryonicKidney,Muscle,Embryo,Embryo,Prostate,FetalLung,Blood,UmbilicalVein,BoneMarrow,FetalLiver,Cervix,Lung,BoneMarrow,Liver,Liver,Blood,BoneMarrow,Cervix,Colon,Blood,BoneMarrow,Cervix,Liver,Lung,BoneMarrow,Cranial,BoneMarrow,Breast,Cranial,Liver,Lung,BoneMarrow,Liver,Blood,Bone,Breast,Cervix,EmbryonicKidney,Endometrium,Liver,Lung,Muscle,Prostate,BoneMarrow,Breast,Blood,BoneMarrow,Brain,Breast,Cervix,Embryo,Liver,MammaryGland,Embryo,Muscle,Blood,Fallopiantubesecretory,MammaryGland,BoneMarrow,Liver,Blood,Brain,Liver,Lung,Embryo,Endometrium,BoneMarrow,Blood,Embryo,Skin,Adipose,Blood,Cervix,EmbryonicKidney,EmbryonicKidney,Embryo,Blood,BoneMarrow,Breast,Breast,Blood,Blood,BoneMarrow,Breast,Cervix,Colon,HeLacontaminant,Liver,Lung,Prostate,UmbilicalVein,AdrenalGland,Blood,BoneMarrow,Brain,Breast,Cervix,Colon,Embryo,EmbryonicKidney,Endometrium,Liver,Lung,Pancreas,BoneMarrow,Breast,Colon,Colon,Blood,BoneMarrow,Brain,Cervix,Embryo,Liver,Lung,Blood,BoneMarrow,Breast,Cordblood,FetalLiver,Kidney,Pleura,Prostate,Prostate,Blood,Brain,Breast,Colon,Embryo,Liver,EmbryonicKidney,EmbryonicKidney,Kidney,EmbryonicKidney,Kidney,Embryo,Embryo,Lung,Embryo,Liver,Lung,Breast,Brain,Colon,Embryo,Lung,Skin,Thyroid,FetalLung,Colon,Blood,BoneMarrow,Colon,Embryo,EmbryonicKidney,Liver,Lung,BoneMarrow,Colon,Embryo,EmbryonicKidney,Lung,Blood,BoneMarrow,Cervix,Cordblood,FetalLiver,HeLacontaminant,Kidney,Liver,BoneMarrow,Blood,Breast,Liver,Blood,Blood,BoneMarrow,Breast,Colon,Embryo,Endometrium,Liver,Muscle,Blood,BoneMarrow,Cervix,Blood,BoneMarrow,Breast,Cervix,Lung,LymphNode,PeritonealEffusion,UmbilicalCord,Blood,Blood,BoneMarrow,Blood,BoneMarrow,Colon,Cordblood,Embryo,FetalLiver,LymphNode,PeripheralBlood,Blood,BoneMarrow,Cervix,Embryo,Liver,Blood,Blood,Brain,Breast,Embryo,Endometrium,Liver,Lung,Coronaryarterysmoothmuscle,Colon,Embryo,BoneMarrow,Liver,Blood,Colon,Blood,BoneMarrow,Breast,Cervix,Colon,EmbryonicKidney,Liver,MammaryGland,Pancreas,Pleura,Prostate,Muscle,BoneMarrow,BoneMarrow,Brain,Breast,Colon,Embryo,Endometrium,Liver,Lung,Breast,Cervix,Cranial,Breast,Cervix,MammaryGland,Skin,Liver,Liver,Embryo,Blood,Bone,Breast,Colon,Embryo,FetalSkin,Foreskin,HCT116,Lung,Skin,Breast,Foreskin,Lung,Prostate,Skin,Thyroid,Bone,Blood,BoneMarrow,Brain,Colon,Embryo,Endometrium,Liver,Lung,Blood,BoneMarrow,Cervix,Embryo,Liver,Blood,Colon,Prostate,EmbryonicKidney,Blood,BoneMarrow,Brain,Cervix,Colon,Embryo,EmbryonicKidney,Endometrium,Liver,Lung,Blood,BoneMarrow,Brain,Colon,EmbryonicKidney,Liver,Lung,BoneMarrow,EmbryonicKidney,Endometrium,Liver,Blood,EmbryonicKidney,Liver,Lung,MammaryGland,BoneMarrow,EmbryonicKidney,BoneMarrow,Breast,Cerebellum,Colon,Kidney,Prostate,PeritonealEffusion,BoneMarrow,Breast,Cervix,Blood,BoneMarrow,Cervix,Colon,Embryo,EmbryonicKidney,BoneMarrow,EmbryonicKidney,EmbryonicKidney,EmbryonicKidney,EmbryonicKidney,EmbryonicKidney,EmbryonicKidney,EmbryonicKidney,Breast,EmbryonicKidney" \
    --path_pattern data/ENPACT_734_2024-07-26/evaluation/{1}_{2}_2024-07-26.logistic.{3}_eval.txt.gz \
    --statistics_file data/ENPACT_734_2024-07-26/statistics/ENPACT_734_2024-07-26.compiled_stats.txt \
    --model_path data/ENPACT_734_2024-07-26/models/{1}_{2}/{1}_{2}_2024-07-26.logistic.rds \
    --weights_file_basename data/ENPACT_734_2024-07-26/statistics/ENPACT_734_2024-07-26.compiled_weights \
    --training_peaks_directory data/ENPACT_734_2024-07-26/sortedbeds
